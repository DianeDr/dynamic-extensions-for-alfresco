<?xml version="1.0" encoding="UTF-8"?>
<model name="obm:bundleModel" xmlns="http://www.alfresco.org/model/dictionary/1.0">

	<description>OSGI Bundle Model</description>
	<author>Laurens Fridael</author>
	<version>1.0</version>

	<imports>
		<import uri="http://www.alfresco.org/model/dictionary/1.0" prefix="d" />
		<import uri="http://www.alfresco.org/model/content/1.0" prefix="cm" />
	</imports>

	<namespaces>
		<namespace prefix="obm" uri="http://www.googlecode.com/alfresco-repository-extensions/model/osgi/bundle/1.0" />
	</namespaces>

	<constraints>
		<constraint name="obm:autoStartConstraint" type="LIST">
			<parameter name="allowedValues">
				<list>
					<value>ENABLED</value>
					<value>FRAMEWORK</value>
					<value>BOOTSTRAP</value>
					<value>DISABLED</value>
				</list>
			</parameter>
			<parameter name="caseSensitive">
				<value>true</value>
			</parameter>
		</constraint>
		<constraint name="obm:bundleTypeConstraint" type="LIST">
			<parameter name="allowedValues">
				<list>
					<value>REPOSITORY_EXTENSIONS</value>
					<value>LIBRARY</value>
				</list>
			</parameter>
			<parameter name="caseSensitive">
				<value>true</value>
			</parameter>
		</constraint>
	</constraints>

	<types>

		<type name="obm:bundleFolder">
			<title>Bundle Folder</title>
			<description>
				Folder for Bundle storage. 
				The OSGI container automatically manages Bundles placed in this type of folder.
			</description>
			<parent>cm:folder</parent>
			<properties>
				<property name="obm:autoStartBundles">
					<title>Start Bundles automatically</title>
					<description>
						Determines whether Bundles placed in this folder are started automatically.
					</description>
					<type>d:text</type>
					<mandatory>true</mandatory>
					<default>DISABLED</default>
					<constraints>
						<constraint ref="obm:autoStartConstraint"/>
					</constraints>
				</property>
				<property name="obm:bundleType">
					<title>Bundle folder type</title>
					<description>
						Determines what type of Bundles are placed in this folder. (Framework, Alfresco extensions.)
					</description>
					<type>d:text</type>
					<mandatory>false</mandatory>
					<constraints>
						<constraint ref="obm:bundleTypeConstraint"/>
					</constraints>
				</property>
			</properties>
		</type>

		<type name="obm:bundle">
			<title>Bundle</title>
			<description>
				Base type for OSGI bundles that defines common metadata properties. 
				Nodes of this type should generally not be created. Use one of the subtypes instead.
			</description>
			<parent>cm:content</parent>
			<properties>
				<property name="obm:symbolicName">
					<title>Symbolic name</title>
					<type>d:text</type>
					<mandatory>false</mandatory>
				</property>
				<property name="obm:version">
					<title>Version</title>
					<type>d:text</type>
					<mandatory>false</mandatory>
				</property>
			</properties>
		</type>

		<type name="obm:managedBundle">
			<title>Managed Bundle</title>
			<description>
				Represents a Bundle managed by the OSGI container.
			</description>
			<parent>obm:bundle</parent>
			<properties>
				<property name="obm:bundleId">
					<title>Bundle ID</title>
					<type>d:long</type>
					<mandatory>false</mandatory>
				</property>
				<property name="obm:state">
					<title>State</title>
					<description>
						The Bundle's state, as defined by the OSGI specification.
						(resolved, installed, started, etc.)
					</description>
					<type>d:text</type>
					<mandatory>false</mandatory>
				</property>
			</properties>
		</type>

	</types>

</model>